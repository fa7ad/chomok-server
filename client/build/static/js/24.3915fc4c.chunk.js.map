{"version":3,"sources":["components/Layout.js","pages/OfferType.js","pages/NotFound.js"],"names":["cdark","css","_templateObject","cnophone","_templateObject2","Section","styled","_ref","dark","nophone","className","p","Object","_ldata_my_projects_chomok_client_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__","react__WEBPACK_IMPORTED_MODULE_3___default","a","createElement","assign","cx","_ldata_my_projects_chomok_client_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","_templateObject3","btn","type","_templateObject4","ButtonLink","Link","Heading","_templateObject5","Content","_templateObject6","qrmodal","_templateObject7","offerType","OfferType","state","loading","types","dict","perc","special","bulk","showOldCode","data","fetch","_id","code","then","r","status","Error","json","res","ok","console","error","_this","showData","catch","download","e","target","toDataURL","document","href","click","Modal","info","title","content","react__WEBPACK_IMPORTED_MODULE_6___default","Fragment","qrcode_react__WEBPACK_IMPORTED_MODULE_8___default","value","onClick","offertype","onOk","navigate","_this$props","this","props","style","zone","_this$state","_components_Loading__WEBPACK_IMPORTED_MODULE_13__","length","_components_Layout__WEBPACK_IMPORTED_MODULE_14__","map","idx","to","concat","key","caption","_NotFound__WEBPACK_IMPORTED_MODULE_12__","_this2","reply","setState","offers","keys","filter","el","React","PureComponent","Wrapper","Box","__webpack_exports__","react__WEBPACK_IMPORTED_MODULE_1___default"],"mappings":"knFAKO,IAAMA,EAAQC,YAAHC,KAYLC,EAAWF,YAAHG,KAoBRC,EAAUC,YAbX,SAAAC,GAAA,IAAGC,EAAHD,EAAGC,KAAMC,EAATF,EAASE,QAASC,EAAlBH,EAAkBG,UAAcC,EAAhCC,OAAAC,EAAA,EAAAD,CAAAL,EAAA,uCACVO,EAAAC,EAAAC,cAAA,UAAAJ,OAAAK,OAAA,CACEP,UAAWQ,YAAGR,EAADE,OAAAO,EAAA,EAAAP,CAAA,GAAeZ,EAAQQ,GAAvBI,OAAAO,EAAA,EAAAP,CAAA,GAAkCT,EAAWM,KACtDE,KAUeL,CAAHc,KAadC,EAAM,SAAAC,GAAI,OAAIhB,YAAOgB,EAAPhB,CAAJiB,MAmBHC,GADSH,EAAI,UACAA,EAAII,MAEjBC,EAAUpB,YAAO,KAAPA,CAAHqB,KAOPC,EAAUtB,YAAO,MAAPA,CAAHuB,KAWPC,EAAU7B,YAAH8B,iXC7EpB,IAAMC,EAAY/B,YAAHC,KAUT+B,6MACJC,MAAQ,CACNC,SAAS,EACTC,MAAO,MAGTC,KAAO,CACLC,KAAM,iBACNC,QAAS,gBACTC,KAAM,mBA0CRC,YAAc,SAAAC,GACZC,MAAM,cAAgBD,EAAKE,IAAM,IAAMF,EAAKG,KAAKvB,MAC9CwB,KAAK,SAAAC,GACJ,GAAiB,MAAbA,EAAEC,OAAgB,MAAM,IAAIC,MAAM,gBACtC,OAAOF,EAAEG,SAEVJ,KAAK,SAAAK,GACJ,IAAKA,EAAIC,GAAI,OAAOC,QAAQC,MAAM,wBAClCC,EAAKC,SAASL,EAAIT,QAEnBe,MAAMJ,QAAQC,UAGnBI,SAAW,SAAAC,GACT,IAAMjB,EAAOiB,EAAEC,OAAOC,UAAU,aAC1B9C,EAAI+C,SAAS9C,cAAc,KACjCD,EAAEgD,KAAOrB,EACT3B,EAAE2C,SAAW,aACb3C,EAAEiD,WAGJR,SAAW,SAAAd,GAAI,OACbuB,IAAMC,KAAK,CACTC,MAAO,0BACPzD,UAAWoB,IACXsC,QACEC,EAAAtD,EAAAC,cAAAqD,EAAAtD,EAAAuD,SAAA,KACED,EAAAtD,EAAAC,cAACuD,EAAAxD,EAAD,CAAQyD,MAAO,YAAc9B,EAAKG,KAAM4B,QAASlB,EAAKG,WACtDW,EAAAtD,EAAAC,cAAA,WAAM0B,EAAKG,MACXwB,EAAAtD,EAAAC,cAAA,oDACAqD,EAAAtD,EAAAC,cAAA,mBAAWuC,EAAKlB,KAAKK,EAAKgC,aAG9BC,KAXS,WAYPC,YAAS,iFAzEL,IAAAC,EACgBC,KAAKC,MAArBC,EADAH,EACAG,MAAOC,EADPJ,EACOI,KADPC,EAEmBJ,KAAK5C,MAAxBE,EAFA8C,EAEA9C,MAER,OAJQ8C,EAEO/C,QAEKkC,EAAAtD,EAAAC,cAACmE,EAAA,EAAD,MAEb/C,EAAMgD,OAAS,EACpBf,EAAAtD,EAAAC,cAACqE,EAAA,EAAD,CAASL,MAAOA,EAAOtE,UAAWsB,GAChCqC,EAAAtD,EAAAC,cAAA,kCACCoB,EAAMkD,IAAI,SAAChE,EAAMiE,GAAP,OACTlB,EAAAtD,EAAAC,cAACqE,EAAA,EAAD,CAAYG,GAAE,UAAAC,OAAYR,EAAZ,KAAAQ,OAAoBnE,EAAKoE,KAAOA,IAAKH,GAChDjE,EAAKqE,YAKZtB,EAAAtD,EAAAC,cAAC4E,EAAA,QAAD,CAASZ,MAAOA,GACdX,EAAAtD,EAAAC,cAAC4E,EAAA,IAAD,KACEvB,EAAAtD,EAAAC,cAAA,2EAMa,IAAA6E,EAAAf,KACnBnC,MAAM,qBAAuBmC,KAAKC,MAAME,MACrCnC,KAAK,SAAAC,GAAC,OAAIA,EAAEG,SACZJ,KAAK,SAAAgD,GACJ,IAAKA,EAAM1C,GAAI,OAAOyC,EAAKE,SAAS,CAAE3D,MAAO,GAAID,SAAS,IAC1D,GAAI2D,EAAMpD,KAAKG,KAAM,OAAOgD,EAAKpD,YAAYqD,EAAMpD,MAFtC,IAGLsD,EAAWF,EAAMpD,KAAjBsD,OACF5D,EAAQ6D,YAAKC,YAAO,SAAAC,GAAE,OAAIA,GAAIH,IACpCH,EAAKE,SAAS,CACZ5D,SAAS,EACTC,MAAOkD,YAAI,SAAAa,GAAE,MAAK,CAAET,IAAKS,EAAIR,QAASE,EAAKxD,KAAK8D,KAAQ/D,cA9C1CgE,IAAMC,eA+FfpE,qoBClHR,IAAMqE,EAAUhG,YAAO,MAAPA,CAAHJ,KAOPqG,EAAMjG,YAAO,MAAPA,CAAHF,KAgBDoG,EAAA,iBAAA7F,GAAC,OACd8F,EAAA1F,EAAAC,cAACsF,EAAD,CAAStB,MAAOrE,EAAEqE,OAChByB,EAAA1F,EAAAC,cAACuF,EAAD,KACEE,EAAA1F,EAAAC,cAAA,iBACAyF,EAAA1F,EAAAC,cAAA","file":"static/js/24.3915fc4c.chunk.js","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport { Link } from '@reach/router'\nimport styled, { css, cx } from 'react-emotion'\n\nexport const cdark = css`\n  background: rgba(0, 0, 0, 0.45);\n  color: #fff;\n  h1,\n  h2,\n  h3,\n  h4,\n  h5 {\n    color: #fefefe;\n  }\n`\n\nexport const cnophone = css`\n  @media (max-width: 639px) {\n    flex-basis: 100%;\n    display: none;\n  }\n`\n\nconst Sec = ({ dark, nophone, className, ...p }) => (\n  <section\n    className={cx(className, { [cdark]: dark }, { [cnophone]: nophone })}\n    {...p}\n  />\n)\n\nSec.propTypes = {\n  dark: PropTypes.bool,\n  nophone: PropTypes.bool,\n  className: PropTypes.string\n}\n\nexport const Section = styled(Sec)`\n  flex-basis: 50%;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  transition: all 300ms ease;\n  @media (max-width: 639px) {\n    flex-basis: 100%;\n  }\n`\n\nconst btn = type => styled(type)`\n  text-transform: uppercase;\n  font-family: Montserrat, sans-serif;\n  padding: 10px;\n  border: solid 2px #fff;\n  color: #fff;\n  cursor: pointer;\n  outline: none;\n  transition: background-position 250ms ease, background-color 225ms 50ms ease;\n  background: transparent linear-gradient(to bottom, #fff 50%, transparent 50%)\n    0 100%/100% 200% no-repeat;\n  &:hover {\n    color: #333;\n    background-color: #fff;\n    background-position: 0 0;\n  }\n`\n\nexport const Button = btn('button')\nexport const ButtonLink = btn(Link)\n\nexport const Heading = styled('h1')`\n  font-family: 'Source Sans Pro', sans-serif;\n  font-size: 4em;\n  color: #fefefe;\n  text-transform: uppercase;\n`\n\nexport const Content = styled('div')`\n  width: 75%;\n  text-align: justify;\n  text-transform: uppercase;\n  font-family: Montserrat, sans-serif;\n  margin-bottom: 1.5em;\n\n  max-height: 50vh;\n  overflow: hidden;\n`\n\nexport const qrmodal = css`\n  .ant-modal-content {\n    background: rgba(0, 0, 0, 0.65);\n    text-align: center;\n    border-radius: 0;\n  }\n  .ant-modal-confirm-content,\n  .ant-modal-confirm-title,\n  h3,\n  pre,\n  span {\n    color: #fff;\n  }\n\n  .ant-modal-confirm-body-wrapper {\n    border: 4px solid #fff;\n    padding: 20px;\n  }\n\n  .ant-modal-confirm-btns {\n    float: none;\n  }\n\n  .ant-modal-confirm-content {\n    margin-left: 0 !important;\n    text-align: center;\n\n    img {\n      width: 100%;\n    }\n  }\n\n  .ant-btn {\n    background: #fff;\n    border-radius: 0;\n    border: none;\n    padding: 0 40px;\n    &,\n    & span {\n      color: #111;\n    }\n  }\n\n  i.anticon {\n    margin-right: 0;\n  }\n`\n","import React from 'react'\nimport { Modal } from 'antd'\nimport QrCode from 'qrcode.react'\nimport PropTypes from 'prop-types'\nimport { css } from 'react-emotion'\nimport { navigate } from '@reach/router'\nimport { map, filter, keys } from 'ramda'\n\nimport { Wrapper, Box } from './NotFound'\nimport Loading from '../components/Loading'\nimport { Section, ButtonLink, qrmodal } from '../components/Layout'\n\nconst offerType = css`\n  flex-basis: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  h1,\n  h2,\n  h3 {\n    color: #fff;\n  }\n`\n\nclass OfferType extends React.PureComponent {\n  state = {\n    loading: true,\n    types: []\n  }\n\n  dict = {\n    perc: 'Percentage Off',\n    special: 'Special Offer',\n    bulk: 'Bulk Discount'\n  }\n\n  render () {\n    const { style, zone } = this.props\n    const { types, loading } = this.state\n\n    if (loading) return <Loading />\n\n    return types.length > 0 ? (\n      <Section style={style} className={offerType}>\n        <h1>Select an offer type</h1>\n        {types.map((type, idx) => (\n          <ButtonLink to={`/offer/${zone}/${type.key}`} key={idx}>\n            {type.caption}\n          </ButtonLink>\n        ))}\n      </Section>\n    ) : (\n      <Wrapper style={style}>\n        <Box>\n          <h1>No offer found!</h1>\n        </Box>\n      </Wrapper>\n    )\n  }\n\n  componentDidMount () {\n    fetch('/api/offers/dhaka/' + this.props.zone)\n      .then(r => r.json())\n      .then(reply => {\n        if (!reply.ok) return this.setState({ types: [], loading: false })\n        if (reply.data.code) return this.showOldCode(reply.data)\n        const { offers } = reply.data\n        const types = keys(filter(el => el, offers))\n        this.setState({\n          loading: false,\n          types: map(el => ({ key: el, caption: this.dict[el] }), types)\n        })\n      })\n  }\n\n  showOldCode = data => {\n    fetch('/api/codes/' + data._id + '/' + data.code.type)\n      .then(r => {\n        if (r.status === 401) throw new Error('Unauthorized')\n        return r.json()\n      })\n      .then(res => {\n        if (!res.ok) return console.error('Something went wrong')\n        this.showData(res.data)\n      })\n      .catch(console.error)\n  }\n\n  download = e => {\n    const data = e.target.toDataURL('image/png')\n    const a = document.createElement('a')\n    a.href = data\n    a.download = 'qrcode.png'\n    a.click()\n  }\n\n  showData = data =>\n    Modal.info({\n      title: 'You already got a code!',\n      className: qrmodal,\n      content: (\n        <>\n          <QrCode value={'chomok://' + data.code} onClick={this.download} />\n          <pre>{data.code}</pre>\n          <em>Click on the QR code to save for later</em>\n          <h3>Type: {this.dict[data.offertype]}</h3>\n        </>\n      ),\n      onOk () {\n        navigate('/')\n      }\n    })\n\n  static propTypes = {\n    style: PropTypes.object,\n    zone: PropTypes.string\n  }\n}\n\nexport default OfferType\n","import React from 'react'\nimport styled from 'react-emotion'\n\nexport const Wrapper = styled('div')`\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\n\nexport const Box = styled('div')`\n  background-color: rgba(255, 255, 255, 0.85);\n  box-shadow: 0 0 5px rgba(255, 255, 255, 0.4);\n  padding: 20px;\n  width: 50%;\n  max-width: 480px;\n\n  h1 {\n    font-weight: 400;\n  }\n  h2 {\n    font-weight: 400;\n    text-transform: uppercase;\n  }\n`\n\nexport default p => (\n  <Wrapper style={p.style}>\n    <Box>\n      <h1>404</h1>\n      <h2>Page not found!</h2>\n    </Box>\n  </Wrapper>\n)\n"],"sourceRoot":""}