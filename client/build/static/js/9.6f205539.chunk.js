(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{331:function(e,t,n){"use strict";n.r(t);var a=n(238),r=n(47),o=n(48),s=n(50),i=n(49),c=n(51),l=n(21),u=n(1),p=n.n(u),m=n(215),d=n.n(m),f=n(22),h=n(13),g=n(262),b=n.n(g),w=n(340),E=n(257),j=n(341),v=n(329),S=n(28),y=n(10);function O(){var e=Object(l.a)(["\n  text-align: left;\n\n  .fileContainer {\n    box-shadow: none;\n  }\n  .chooseFileButton {\n    border-radius: 3px;\n  }\n"]);return O=function(){return e},e}var k=w.a.Item,z=E.a.Option,D=Object(f.a)(O()),P=function(e){return new Promise(function(t){var n=new FileReader;n.addEventListener("loadend",function(e){t(n.result)}),n.readAsDataURL(e)})},Y=function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={zones:[],partners:[],progress:"plus"},n.handleSubmit=function(e){e.preventDefault(),n.setState({progress:"loading"}),n.props.form.validateFieldsAndScroll(function(e,t){if(e)return n.setState({progress:"close"});t.date=t.date.format("YYYYMMDD"),P(t.image[0]).then(function(e){return JSON.stringify(Object(a.a)({},t,{percentage:+t.percentage,image:e}))}).then(function(e){return fetch("/api/offers",{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:e})}).then(function(e){return 401===e.status&&Object(h.e)("/login"),e.json()}).then(function(e){if(!e.ok)throw new Error("Something wrong, again!");n.setState({progress:"check"}),Object(h.e)("/admin/offers")}).catch(function(e){n.setState({progress:"close"}),console.error(e)})})},n}return Object(c.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return p.a.createElement(w.a,{onSubmit:this.handleSubmit,className:D},p.a.createElement(k,null,e("image",{rules:[{required:!0,message:"Please upload an image!"}]})(p.a.createElement(b.a,{withIcon:!0,singleImage:!0,buttonText:"Choose image",imgExtension:[".jpg",".png"],maxFileSize:2098e3}))),p.a.createElement(k,null,e("date",{rules:[{type:"object",required:!0,message:"Please select a date!"}],initialValue:d()()})(p.a.createElement(j.a,{format:"DD-MM-YYYY"}))),p.a.createElement(k,null,e("zoneid",{rules:[{required:!0,message:"Please select a zone!"}]})(p.a.createElement(E.a,{placeholder:"Select a zone"},this.state.zones))),p.a.createElement(k,null,e("partnerid",{rules:[{required:!0,message:"Please select a partner!"}]})(p.a.createElement(E.a,{placeholder:"Select a partner"},this.state.partners))),p.a.createElement(k,null,e("percentage",{rules:[{required:!0,message:"Please enter a percentage!"}]})(p.a.createElement(v.a,{type:"number",min:1,max:100,placeholder:"Enter a percentage"}))),p.a.createElement(k,null,p.a.createElement(S.a,{type:"close"===this.state.progress?"danger":"primary",htmlType:"submit"},p.a.createElement(y.a,{type:this.state.progress}))))}},{key:"componentDidMount",value:function(){var e=this;fetch("/api/zones",{credentials:"include"}).then(function(e){return 401===e.status&&Object(h.e)("/login"),e.json()}).then(function(t){if(!t.ok)throw new Error("Something went wrong");var n=t.data.map(function(e){return p.a.createElement(z,{key:e._id,value:e._id},e.division.toUpperCase()," > ",e.name.toUpperCase())});e.setState({zones:n})}).catch(function(e){return console.error(e)}),fetch("/api/users/partner",{credentials:"include"}).then(function(e){return 401===e.status&&Object(h.e)("/login"),e.json()}).then(function(t){if(!t.ok)throw new Error("Something went wrong");var n=t.data.map(function(e){return p.a.createElement(z,{key:e._id,value:e._id},e.name," / ",e.business.name)});e.setState({partners:n})}).catch(function(e){return console.error(e)})}}]),t}(p.a.PureComponent),x=w.a.create()(Y);t.default=x}}]);
//# sourceMappingURL=9.6f205539.chunk.js.map