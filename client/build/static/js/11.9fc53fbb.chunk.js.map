{"version":3,"sources":["../node_modules/antd/es/avatar/index.js","pages/_admin/Offers.js"],"names":["babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default","n","babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__","babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default","babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_2___default","babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3__","babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_3___default","babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__","babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4___default","babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__","babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default","react__WEBPACK_IMPORTED_MODULE_6__","react_dom__WEBPACK_IMPORTED_MODULE_7__","_icon__WEBPACK_IMPORTED_MODULE_8__","classnames__WEBPACK_IMPORTED_MODULE_9__","classnames__WEBPACK_IMPORTED_MODULE_9___default","__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","Avatar","_React$Component","props","this","_this","__proto__","getPrototypeOf","setScale","childrenNode","avatarChildren","childrenWidth","offsetWidth","avatarWidth","getBoundingClientRect","width","setState","scale","handleImgLoadError","onError","undefined","isImgExist","state","key","value","prevProps","prevState","children","_classNames","_classNames2","_this2","_a","prefixCls","shape","size","src","icon","className","alt","others","_state","sizeCls","classString","sizeStyle","height","lineHeight","fontSize","type","childrenStyle","msTransform","WebkitTransform","transform","position","display","left","Math","round","sizeChildrenStyle","ref","span","style","__webpack_exports__","defaultProps","AdminOffersPage","offers","loading","listStyle","textAlign","listMapper","item","idx","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","antd__WEBPACK_IMPORTED_MODULE_9__","Item","actions","antd__WEBPACK_IMPORTED_MODULE_10__","onClick","deleteItem","_id","Meta","avatar","antd__WEBPACK_IMPORTED_MODULE_11__","image","title","getItemTitle","description","getItemDesc","date","moment","isToday","isSame","text","format","Fragment","antd__WEBPACK_IMPORTED_MODULE_12__","color","partner","name","toUpper","zone","division","reqBy","useBy","id","fetch","method","credentials","then","res","json","_ref","ok","Error","slice","splice","catch","console","error","itemLayout","dataSource","renderItem","r","status","navigate","_ref2","data","React","PureComponent"],"mappings":"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","file":"static/js/11.9fc53fbb.chunk.js","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _defineProperty from 'babel-runtime/helpers/defineProperty';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport Icon from '../icon';\nimport classNames from 'classnames';\n\nvar Avatar = function (_React$Component) {\n  _inherits(Avatar, _React$Component);\n\n  function Avatar(props) {\n    _classCallCheck(this, Avatar);\n\n    var _this = _possibleConstructorReturn(this, (Avatar.__proto__ || Object.getPrototypeOf(Avatar)).call(this, props));\n\n    _this.setScale = function () {\n      var childrenNode = _this.avatarChildren;\n\n      if (childrenNode) {\n        var childrenWidth = childrenNode.offsetWidth;\n        var avatarNode = ReactDOM.findDOMNode(_this);\n        var avatarWidth = avatarNode.getBoundingClientRect().width; // add 4px gap for each side to get better performance\n\n        if (avatarWidth - 8 < childrenWidth) {\n          _this.setState({\n            scale: (avatarWidth - 8) / childrenWidth\n          });\n        } else {\n          _this.setState({\n            scale: 1\n          });\n        }\n      }\n    };\n\n    _this.handleImgLoadError = function () {\n      var onError = _this.props.onError;\n      var errorFlag = onError ? onError() : undefined;\n\n      if (errorFlag !== false) {\n        _this.setState({\n          isImgExist: false\n        });\n      }\n    };\n\n    _this.state = {\n      scale: 1,\n      isImgExist: true\n    };\n    return _this;\n  }\n\n  _createClass(Avatar, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      this.setScale();\n    }\n  }, {\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (prevProps.children !== this.props.children || prevState.scale !== this.state.scale && this.state.scale === 1 || prevState.isImgExist !== this.state.isImgExist) {\n        this.setScale();\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _classNames,\n          _classNames2,\n          _this2 = this;\n\n      var _a = this.props,\n          prefixCls = _a.prefixCls,\n          shape = _a.shape,\n          size = _a.size,\n          src = _a.src,\n          icon = _a.icon,\n          className = _a.className,\n          alt = _a.alt,\n          others = __rest(_a, [\"prefixCls\", \"shape\", \"size\", \"src\", \"icon\", \"className\", \"alt\"]);\n\n      var _state = this.state,\n          isImgExist = _state.isImgExist,\n          scale = _state.scale;\n      var sizeCls = classNames((_classNames = {}, _defineProperty(_classNames, prefixCls + '-lg', size === 'large'), _defineProperty(_classNames, prefixCls + '-sm', size === 'small'), _classNames));\n      var classString = classNames(prefixCls, className, sizeCls, (_classNames2 = {}, _defineProperty(_classNames2, prefixCls + '-' + shape, shape), _defineProperty(_classNames2, prefixCls + '-image', src && isImgExist), _defineProperty(_classNames2, prefixCls + '-icon', icon), _classNames2));\n      var sizeStyle = typeof size === 'number' ? {\n        width: size,\n        height: size,\n        lineHeight: size + 'px',\n        fontSize: icon ? size / 2 : 18\n      } : {};\n      var children = this.props.children;\n\n      if (src && isImgExist) {\n        children = React.createElement('img', {\n          src: src,\n          onError: this.handleImgLoadError,\n          alt: alt\n        });\n      } else if (icon) {\n        children = React.createElement(Icon, {\n          type: icon\n        });\n      } else {\n        var childrenNode = this.avatarChildren;\n\n        if (childrenNode || scale !== 1) {\n          var childrenStyle = {\n            msTransform: 'scale(' + scale + ')',\n            WebkitTransform: 'scale(' + scale + ')',\n            transform: 'scale(' + scale + ')',\n            position: 'absolute',\n            display: 'inline-block',\n            left: 'calc(50% - ' + Math.round(childrenNode.offsetWidth / 2) + 'px)'\n          };\n          var sizeChildrenStyle = typeof size === 'number' ? {\n            lineHeight: size + 'px'\n          } : {};\n          children = React.createElement('span', {\n            className: prefixCls + '-string',\n            ref: function ref(span) {\n              return _this2.avatarChildren = span;\n            },\n            style: _extends({}, sizeChildrenStyle, childrenStyle)\n          }, children);\n        } else {\n          children = React.createElement('span', {\n            className: prefixCls + '-string',\n            ref: function ref(span) {\n              return _this2.avatarChildren = span;\n            }\n          }, children);\n        }\n      }\n\n      return React.createElement('span', _extends({}, others, {\n        style: _extends({}, sizeStyle, others.style),\n        className: classString\n      }), children);\n    }\n  }]);\n\n  return Avatar;\n}(React.Component);\n\nexport default Avatar;\nAvatar.defaultProps = {\n  prefixCls: 'ant-avatar',\n  shape: 'circle',\n  size: 'default'\n};","import React from 'react'\nimport moment from 'moment'\nimport { toUpper } from 'ramda'\nimport { navigate } from '@reach/router'\nimport { List, Avatar, Button, Tag } from 'antd'\n\nclass AdminOffersPage extends React.PureComponent {\n  state = {\n    offers: [],\n    loading: true\n  }\n\n  listStyle = {\n    textAlign: 'left'\n  }\n\n  render () {\n    return (\n      <List\n        loading={this.state.loading}\n        itemLayout='horizontal'\n        dataSource={this.state.offers}\n        renderItem={this.listMapper}\n      />\n    )\n  }\n\n  componentDidMount () {\n    fetch('/api/offers', { credentials: 'include' })\n      .then(r => {\n        if (r.status === 401) navigate('/login')\n        return r.json()\n      })\n      .then(({ ok, data }) => {\n        if (!ok) throw new Error('Something went wrong')\n        this.setState({ offers: data, loading: false })\n      })\n      .catch(e => {\n        console.error(e)\n      })\n  }\n\n  listMapper = (item, idx) => (\n    <List.Item\n      actions={[\n        <Button onClick={this.deleteItem(item._id, idx)} type='danger'>\n          DELETE!\n        </Button>\n      ]}\n      key={item._id}>\n      <List.Item.Meta\n        avatar={<Avatar src={item.image} size='large' shape='square' />}\n        title={this.getItemTitle(item)}\n        description={this.getItemDesc(item)}\n        style={this.listStyle}\n      />\n    </List.Item>\n  )\n\n  getItemTitle = item => {\n    const date = moment(item.date, 'YYYYMMDD')\n    const isToday = date.isSame(moment(), 'day')\n    const text = date.format('DD-MM-YYYY')\n    return (\n      <>\n        <Tag color={isToday ? 'cyan' : 'magenta'}>\n          <b>Date: </b> {isToday ? 'Today / ' : ''}\n          {text}\n        </Tag>\n        <Tag color='red'>\n          <b>Name:</b> {item.partner.name}\n        </Tag>\n        <Tag color='orange'>\n          <b>Zone:</b> {toUpper(item.zone.division + ' > ' + item.zone.name)}\n        </Tag>\n      </>\n    )\n  }\n\n  getItemDesc = item => (\n    <>\n      <Tag color='blue'>\n        <b>Request:</b> {item.reqBy.length}\n      </Tag>\n      <Tag color='green'>\n        <b>Used:</b> {item.useBy.length}\n      </Tag>\n      <Tag color='pink'>\n        <b>Unused:</b> {item.reqBy.length - item.useBy.length}\n      </Tag>\n    </>\n  )\n\n  deleteItem = (id, idx) => e => {\n    fetch('/api/offers/' + id, {\n      method: 'DELETE',\n      credentials: 'include'\n    })\n      .then(res => res.json())\n      .then(({ ok }) => {\n        if (ok) {\n          this.setState(p => {\n            const offers = p.offers.slice()\n            offers.splice(idx, 1)\n            return { offers }\n          })\n        } else {\n          throw new Error('Something went wrong')\n        }\n      })\n      .catch(e => {\n        console.error(e)\n      })\n  }\n}\n\nexport default AdminOffersPage\n"],"sourceRoot":""}