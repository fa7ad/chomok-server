{"version":3,"sources":["pages/NotFound.js","components/Layout.js","img/wheelofluck.png","pages/Offer.js"],"names":["Wrapper","styled","_templateObject","Box","_templateObject2","__webpack_exports__","p","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","style","cdark","css","cnophone","Section","_ref","dark","nophone","className","Object","_ldata_my_projects_chomok_client_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_1__","react__WEBPACK_IMPORTED_MODULE_3___default","assign","cx","_ldata_my_projects_chomok_client_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","_templateObject3","Button","_templateObject4","module","exports","__webpack_require__","section","Zone","HexImg","concat","Wheel","WheelWrapper","_templateObject5","WheelPin","Icon","_templateObject6","spin","_templateObject7","max","min","Math","floor","random","qrmodal","_templateObject8","qrModal","qr","code","Modal","info","title","content","react__WEBPACK_IMPORTED_MODULE_7___default","Fragment","src","alt","Offer","state","offer","spinning","e","preventDefault","_this","getQr","_id","setState","stopSpin","setTimeout","showQR","id","fetch","credentials","then","r","status","navigate","json","res","ok","data","_this$props","this","props","zone","_components_Loading__WEBPACK_IMPORTED_MODULE_14__","_components_Layout__WEBPACK_IMPORTED_MODULE_12__","antd__WEBPACK_IMPORTED_MODULE_8__","type","theme","data-bg","image","data-size","onClick","partner","name","address","color","fontSize","wheel","onAnimationEnd","_NotFound__WEBPACK_IMPORTED_MODULE_13__","_this2","reply","React","PureComponent"],"mappings":"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","file":"static/js/16.8205f4f1.chunk.js","sourcesContent":["import React from 'react'\nimport styled from 'react-emotion'\n\nexport const Wrapper = styled('div')`\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`\n\nexport const Box = styled('div')`\n  background-color: rgba(255, 255, 255, 0.85);\n  box-shadow: 0 0 5px rgba(255, 255, 255, 0.85);\n  border-radius: 5px;\n  padding: 20px;\n  width: 50%;\n  max-width: 480px;\n\n  h1 {\n    font-weight: 900;\n  }\n  h2 {\n    font-weight: 400;\n    text-transform: uppercase;\n  }\n`\n\nexport default p => (\n  <Wrapper style={p.style}>\n    <Box>\n      <h1>404</h1>\n      <h2>Page not found!</h2>\n    </Box>\n  </Wrapper>\n)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled, { css, cx } from 'react-emotion'\n\nexport const cdark = css`\n  background: rgba(0, 0, 0, 0.45);\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.6);\n  }\n`\n\nexport const cnophone = css`\n  @media (max-width: 640px) {\n    flex-basis: 100%;\n    display: none;\n  }\n`\n\nconst Sec = ({ dark, nophone, className, ...p }) => (\n  <section\n    className={cx(className, { [cdark]: dark }, { [cnophone]: nophone })}\n    {...p}\n  />\n)\n\nSec.propTypes = {\n  dark: PropTypes.bool,\n  nophone: PropTypes.bool,\n  className: PropTypes.string\n}\n\nexport const Section = styled(Sec)`\n  flex-basis: 50%;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  transition: all 300ms ease;\n  @media (max-width: 640px) {\n    flex-basis: 100%;\n  }\n`\n\nexport const Button = styled('button')`\n  text-transform: uppercase;\n  font-family: Montserrat, sans-serif;\n  padding: 10px;\n  border: solid 2px #fff;\n  color: #fff;\n  cursor: pointer;\n  outline: none;\n  transition: all 250ms ease;\n  background-color: transparent;\n  background-size: 100% 200%;\n  background-image: linear-gradient(to bottom, transparent 50%, white 50%);\n\n  &:hover {\n    color: #333;\n    background-position: 0 -100%;\n  }\n`\n","module.exports = __webpack_public_path__ + \"static/media/wheelofluck.d7943fdb.png\";","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { Icon, Modal } from 'antd'\nimport { navigate } from '@reach/router'\nimport styled, { css, cx } from 'react-emotion'\n\nimport { Section, Button } from '../components/Layout'\nimport { Wrapper, Box } from './NotFound'\nimport Loading from '../components/Loading'\n\nimport wheel from '../img/wheelofluck.png'\n\nconst section = css`\n  &&& {\n    justify-content: flex-start;\n  }\n  .shrink {\n    flex-shrink: 1;\n  }\n  .descr {\n    flex-basis: 20%;\n    text-transform: uppercase;\n  }\n  .spin-cta {\n    margin: 5% auto;\n  }\n  .hex-img {\n    margin: 10% auto;\n  }\n`\n\nconst Zone = styled('div')`\n  font-size: 1.2em;\n  text-transform: uppercase;\n  display: inline-flex;\n  justify-content: center;\n  align-items: center;\n  padding: 5px;\n\n  span {\n    font-weight: 300;\n    font-size: 1.1em;\n    margin: 0 5px;\n  }\n`\n\nconst HexImg = styled('div')`\n  clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);\n  min-height: ${p => p['data-size']};\n  width: ${p => p['data-size']};\n  background-image: ${p => `url(${p['data-bg']})`};\n  background-position: center center;\n  background-size: 100% 100%;\n  background-repeat: no-repeat;\n  transition: background-size 150ms ease;\n  &:hover {\n    background-size: 120% 120%;\n  }\n`\n\nconst Wheel = styled('img')`\n  position: relative;\n  width: 75%;\n  transform: rotate(143deg);\n`\n\nconst WheelWrapper = styled('div')`\n  display: flex;\n  flex-direction: column;\n  justify-content: stretch;\n  align-items: center;\n`\n\nconst WheelPin = styled(Icon)`\n  position: relative;\n  top: 40px;\n  z-index: 2;\n`\n\nconst rand = (min, max) => min + Math.floor(Math.random() * (max - min))\n\nconst spin = () => css`\n  animation: spin 2s ease-out 1;\n  transform-origin: center center;\n  @keyframes spin {\n    from {\n      transform: rotate(143deg);\n    }\n    to {\n      transform: rotate(${143 + 360 * rand(3, 10)}deg);\n    }\n  }\n`\n\nconst qrmodal = css`\n  .ant-confirm-content {\n    margin-left: 0 !important;\n    text-align: center;\n\n    img {\n      width: 100%;\n    }\n  }\n`\n\nconst qrModal = function (qr, code) {\n  Modal.info({\n    title: 'Show this code to the partner',\n    content: (\n      <>\n        <img src={qr} alt='code' />\n        <h3>{code}</h3>\n      </>\n    ),\n    className: qrmodal\n  })\n}\n\nclass Offer extends React.PureComponent {\n  state = {\n    offer: 'loading',\n    spinning: false,\n    qr: null\n  }\n  render () {\n    const { zone, style } = this.props\n    if (!this.state.offer) {\n      return (\n        <Wrapper style={style}>\n          <Box>\n            <h1>No offer found!</h1>\n          </Box>\n        </Wrapper>\n      )\n    }\n\n    if (this.state.offer === 'loading') return <Loading />\n\n    return (\n      <>\n        <Section dark style={style} className={section}>\n          <Zone className='shrink'>\n            <Icon type='environment' theme='filled' />\n            <span>{zone}</span>\n          </Zone>\n          <HexImg\n            data-bg={this.state.offer.image}\n            data-size='40vmin'\n            className='hex-img'\n          />\n          <div className='spin-cta'>\n            <div>SPIN THE WHEEL TO GET YOUR % OFF!</div>\n            <Button onClick={this.spin}>Spin the wheel!</Button>\n          </div>\n          <div className='descr'>\n            {this.state.offer.partner.name}\n            <br />\n            <Icon type='compass' /> {this.state.offer.partner.address}\n          </div>\n        </Section>\n        <Section style={style}>\n          <WheelWrapper>\n            <WheelPin\n              style={{ color: '#d12', fontSize: '48px' }}\n              type='caret-down'\n            />\n            <Wheel\n              className={cx({ [spin()]: this.state.spinning })}\n              src={wheel}\n              alt='wheel'\n              onAnimationEnd={this.stopSpin}\n              onClick={this.spin}\n            />\n          </WheelWrapper>\n        </Section>\n      </>\n    )\n  }\n\n  componentDidMount () {\n    fetch('/api/offers/dhaka/' + this.props.zone)\n      .then(r => r.json())\n      .then(reply => {\n        if (!reply.ok) this.setState({ offer: false })\n        this.setState({ offer: reply.data })\n      })\n  }\n\n  spin = e => {\n    e.preventDefault()\n    this.getQr(this.state.offer._id)\n    this.setState({ spinning: true })\n  }\n\n  stopSpin = e => {\n    this.setState({ spinning: false })\n    setTimeout(this.showQR(this.state.qr.qr, this.state.qr.code), 500)\n  }\n\n  getQr = id =>\n    fetch('/api/codes/' + id, {\n      credentials: 'include'\n    })\n      .then(r => {\n        if (r.status === 401) navigate('/login')\n        return r.json()\n      })\n      .then(res => {\n        if (!res.ok) this.setState({ offer: false })\n        this.setState({ qr: res.data })\n      })\n\n  showQR = (qr, code) => e => qrModal(qr, code)\n\n  static propTypes = {\n    style: PropTypes.object,\n    zone: PropTypes.string.isRequired\n  }\n}\n\nexport default Offer\n"],"sourceRoot":""}