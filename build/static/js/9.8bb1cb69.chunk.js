(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{313:function(e,t,n){"use strict";n.r(t);var a=n(220),r=n(75),o=n(76),s=n(78),i=n(77),c=n(79),l=n(1),u=n.n(l),p=n(315),m=n(238),d=n(310),h=n(82),f=n(15),g=n(252),w=n.n(g),E=n(12),b=p.a.Item,S=m.a.Option,v=function(e){return new Promise(function(t){var n=new FileReader;n.addEventListener("loadend",function(e){t(n.result)}),n.readAsDataURL(e)})},j=function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={zones:[],partners:[],progress:"plus"},n.handleSubmit=function(e){e.preventDefault(),n.setState({progress:"loading"}),n.props.form.validateFieldsAndScroll(function(e,t){e?n.setState({progress:"close"}):v(t.image[0]).then(function(e){return JSON.stringify(Object(a.a)({},t,{percentage:+t.percentage,image:e}))}).then(function(e){return fetch("/api/offers",{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:e})}).then(function(e){return e.json()}).then(function(e){if(!e.ok)throw new Error("Something wrong, again!");n.setState({progress:"check"}),Object(E.e)("/admin/offers")}).catch(function(e){return console.error(e)})})},n}return Object(c.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return u.a.createElement(p.a,{onSubmit:this.handleSubmit},u.a.createElement(b,null,e("image",{rules:[{required:!0,message:"Please upload an image!"}]})(u.a.createElement(w.a,{withIcon:!0,singleImage:!0,buttonText:"Choose image",imgExtension:[".jpg",".png"],maxFileSize:2098e3}))),u.a.createElement(b,null,e("zoneid",{rules:[{required:!0,message:"Please select a zone!"}]})(u.a.createElement(m.a,{placeholder:"Select a zone"},this.state.zones))),u.a.createElement(b,null,e("partnerid",{rules:[{required:!0,message:"Please select a partner!"}]})(u.a.createElement(m.a,{placeholder:"Select a partner"},this.state.partners))),u.a.createElement(b,null,e("percentage",{rules:[{required:!0,message:"Please enter a percentage!"}]})(u.a.createElement(d.a,null))),u.a.createElement(b,null,u.a.createElement(h.a,{type:"close"===this.state.progress?"danger":"primary",htmlType:"submit"},u.a.createElement(f.a,{type:"plus"}))))}},{key:"componentDidMount",value:function(){var e=this;fetch("/api/zones",{credentials:"include"}).then(function(e){return 401===e.status&&Object(E.e)("/login"),e.json()}).then(function(t){if(!t.ok)throw new Error("Something went wrong");var n=t.data.map(function(e){return u.a.createElement(S,{key:e._id,value:e._id},e.division.toUpperCase()," > ",e.name.toUpperCase())});e.setState({zones:n})}).catch(function(e){return console.error(e)}),fetch("/api/users/partner",{credentials:"include"}).then(function(e){return 401===e.status&&Object(E.e)("/login"),e.json()}).then(function(t){if(!t.ok)throw new Error("Something went wrong");var n=t.data.map(function(e){return u.a.createElement(S,{key:e._id,value:e._id},e.name," / ",e.business.name)});e.setState({partners:n})}).catch(function(e){return console.error(e)})}}]),t}(u.a.PureComponent),y=p.a.create()(j);t.default=y}}]);
//# sourceMappingURL=9.8bb1cb69.chunk.js.map