(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{331:function(e,t,n){"use strict";n.r(t);var a=n(228),r=n(76),o=n(77),s=n(79),i=n(78),c=n(80),l=n(27),u=n(1),p=n.n(u),m=n(28),d=n(12),f=n(262),h=n.n(f),g=n(334),w=n(255),b=n(335),E=n(327),v=n(84),S=n(15);function j(){var e=Object(l.a)(["\n  text-align: left;\n  .ant-row {\n    max-width: 50vw;\n  }\n  .fileContainer {\n    box-shadow: none;\n  }\n  .chooseFileButton {\n    border-radius: 3px;\n  }\n"]);return j=function(){return e},e}var y=g.a.Item,O=w.a.Option,k=Object(m.a)(j()),x=function(e){return new Promise(function(t){var n=new FileReader;n.addEventListener("loadend",function(e){t(n.result)}),n.readAsDataURL(e)})},z=function(e){function t(){var e,n;Object(r.a)(this,t);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return(n=Object(s.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={zones:[],partners:[],progress:"plus"},n.handleSubmit=function(e){e.preventDefault(),n.setState({progress:"loading"}),n.props.form.validateFieldsAndScroll(function(e,t){if(e)return n.setState({progress:"close"});t.date=t.date.format("YYYYMMDD"),x(t.image[0]).then(function(e){return JSON.stringify(Object(a.a)({},t,{percentage:+t.percentage,image:e}))}).then(function(e){return fetch("/api/offers",{credentials:"include",method:"POST",headers:{"Content-Type":"application/json"},body:e})}).then(function(e){return e.json()}).then(function(e){if(!e.ok)throw new Error("Something wrong, again!");n.setState({progress:"check"}),Object(d.e)("/admin/offers")}).catch(function(e){n.setState({progress:"close"}),console.error(e)})})},n}return Object(c.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return p.a.createElement(g.a,{onSubmit:this.handleSubmit,className:k},p.a.createElement(y,null,e("image",{rules:[{required:!0,message:"Please upload an image!"}]})(p.a.createElement(h.a,{withIcon:!0,singleImage:!0,buttonText:"Choose image",imgExtension:[".jpg",".png"],maxFileSize:2098e3}))),p.a.createElement(y,null,e("date",{rules:[{type:"object",required:!0,message:"Please select a date!"}]})(p.a.createElement(b.a,{format:"DD-MM-YYYY"}))),p.a.createElement(y,null,e("zoneid",{rules:[{required:!0,message:"Please select a zone!"}]})(p.a.createElement(w.a,{placeholder:"Select a zone"},this.state.zones))),p.a.createElement(y,null,e("partnerid",{rules:[{required:!0,message:"Please select a partner!"}]})(p.a.createElement(w.a,{placeholder:"Select a partner"},this.state.partners))),p.a.createElement(y,null,e("percentage",{rules:[{required:!0,message:"Please enter a percentage!"}]})(p.a.createElement(E.a,{type:"number",min:1,max:100,placeholder:"Enter a percentage"}))),p.a.createElement(y,null,p.a.createElement(v.a,{type:"close"===this.state.progress?"danger":"primary",htmlType:"submit"},p.a.createElement(S.a,{type:this.state.progress}))))}},{key:"componentDidMount",value:function(){var e=this;fetch("/api/zones",{credentials:"include"}).then(function(e){return 401===e.status&&Object(d.e)("/login"),e.json()}).then(function(t){if(!t.ok)throw new Error("Something went wrong");var n=t.data.map(function(e){return p.a.createElement(O,{key:e._id,value:e._id},e.division.toUpperCase()," > ",e.name.toUpperCase())});e.setState({zones:n})}).catch(function(e){return console.error(e)}),fetch("/api/users/partner",{credentials:"include"}).then(function(e){return 401===e.status&&Object(d.e)("/login"),e.json()}).then(function(t){if(!t.ok)throw new Error("Something went wrong");var n=t.data.map(function(e){return p.a.createElement(O,{key:e._id,value:e._id},e.name," / ",e.business.name)});e.setState({partners:n})}).catch(function(e){return console.error(e)})}}]),t}(p.a.PureComponent),D=g.a.create()(z);t.default=D}}]);
//# sourceMappingURL=12.d7353af3.chunk.js.map